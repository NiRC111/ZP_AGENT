<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Government Quasi-Judicial AI System ‚Äî ZP Chandrapur</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Roboto','Noto Sans Devanagari',sans-serif;background:#f5f6fa;color:#1f2d3d}
  .header{background:#fff;border-bottom:3px solid #ff9933}
  .header__in{max-width:1100px;margin:0 auto;display:flex;gap:16px;align-items:center;justify-content:space-between;padding:14px 16px}
  .brand{display:flex;gap:14px;align-items:center}
  .emblem{width:56px;height:56px;border-radius:50%;background:radial-gradient(circle,#ffd54f 0,#ffa000 70%);display:flex;align-items:center;justify-content:center;font-weight:700;color:#6d4c41}
  .title{line-height:1.15}
  .title b{color:#ff6b00}
  .badge{background:#138808;color:#fff;border-radius:999px;padding:6px 12px;font-size:12px;font-weight:700}
  .wrap{max-width:1100px;margin:18px auto;padding:0 16px}
  .card{background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:16px;margin-bottom:14px}
  .card h2{font-size:18px;border-bottom:2px solid #ff9933;padding-bottom:10px;margin-bottom:12px}
  label{font-weight:700;margin:8px 0 6px;display:block}
  input[type=text],textarea,select{width:100%;padding:10px;border:2px solid #e2e8f0;border-radius:8px;background:#fff;color:#1f2d3d}
  input[type=file]{display:none}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .btns{display:flex;gap:10px;flex-wrap:wrap}
  .btn{border:0;border-radius:10px;color:#fff;padding:12px 16px;font-weight:800;cursor:pointer}
  .b1{background:linear-gradient(135deg,#667eea,#764ba2)}
  .b2{background:linear-gradient(135deg,#f093fb,#f5576c)}
  .b3{background:linear-gradient(135deg,#4facfe,#00f2fe)}
  .b4{background:linear-gradient(135deg,#43e97b,#38f9d7)}
  .upload{border:2px dashed #90caf9;border-radius:10px;padding:14px;text-align:center;background:#f8fbff;cursor:pointer}
  .pill{background:#eef2ff;border:1px solid #c7d2fe;color:#1e3a8a;border-radius:8px;padding:6px 10px;display:inline-flex;gap:8px;align-items:center}
  .status{display:none;margin:10px 0;padding:10px;border-radius:8px;font-weight:700}
  .ok{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
  .warn{background:#fff3cd;color:#856404;border:1px solid #ffeeba}
  .err{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
  .output{display:none}
  .output.active{display:block}
  .output h3{font-size:18px;margin-bottom:8px}
  .mono{white-space:pre-wrap;line-height:1.8;border:1px solid #e5e7eb;border-radius:10px;padding:14px;background:#fcfcfe}
  .lang{display:flex;gap:8px}
  .lang button{border:2px solid #ff9933;background:#fff;color:#ff6b00;border-radius:999px;padding:6px 10px;font-weight:800;cursor:pointer}
  .lang .on{background:#ff9933;color:#fff}
  @media(max-width:860px){.row{grid-template-columns:1fr}}
</style>
</head>
<body>
<header class="header">
  <div class="header__in">
    <div class="brand">
      <div class="emblem">‡§∂‡§æ‡§∏‡§®</div>
      <div class="title">
        <div><b>‡§ú‡§ø‡§≤‡•ç‡§π‡§æ ‡§™‡§∞‡§ø‡§∑‡§¶ ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§™‡•Ç‡§∞</b></div>
        <div>Zilla Parishad Chandrapur ‚Äî CEO Office</div>
      </div>
    </div>
    <div class="lang">
      <button id="lang-mr" class="on" onclick="setLang('marathi')">‡§Æ‡§∞‡§æ‡§†‡•Ä</button>
      <button id="lang-en" onclick="setLang('english')">English</button>
      <span class="badge">üîí Secure Government Portal</span>
    </div>
  </div>
</header>

<div class="wrap">
  <!-- Documents -->
  <div class="card">
    <h2>üìÅ ‡§ï‡§æ‡§ó‡§¶‡§™‡§§‡•ç‡§∞ ‡§Ö‡§™‡§≤‡•ã‡§° (Case + GR ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø)</h2>
    <div class="row">
      <div>
        <label>Case File (PDF/DOCX/Image) *</label>
        <div class="upload" onclick="document.getElementById('caseFile').click()">Click to upload Case</div>
        <input id="caseFile" type="file" accept=".pdf,.docx,image/*" />
        <div id="caseName" class="pill" style="margin-top:8px;display:none">‚úÖ <span></span></div>
        <label style="margin-top:10px">Alternative: Paste Case Text (optional)</label>
        <textarea id="caseText" rows="6" placeholder="‡§™‡•ç‡§∞‡§ï‡§∞‡§£‡§æ‡§ö‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§á‡§•‡•á ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§æ (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)"></textarea>
      </div>
      <div>
        <label>Government Resolution (GR) (PDF/DOCX/Image) *</label>
        <div class="upload" onclick="document.getElementById('grFile').click()">Click to upload GR</div>
        <input id="grFile" type="file" accept=".pdf,.docx,image/*" />
        <div id="grName" class="pill" style="margin-top:8px;display:none">‚úÖ <span></span></div>
        <label style="margin-top:10px">Alternative: Paste GR Text (optional)</label>
        <textarea id="grText" rows="6" placeholder="GR ‡§ö‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§á‡§•‡•á ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§æ (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)"></textarea>
      </div>
    </div>
  </div>

  <!-- Case Info -->
  <div class="card">
    <h2>‚öñÔ∏è ‡§™‡•ç‡§∞‡§ï‡§∞‡§£ ‡§§‡§™‡§∂‡•Ä‡§≤</h2>
    <div class="row">
      <div>
        <label>‡§™‡•ç‡§∞‡§ï‡§∞‡§£ ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï (Case No.)</label>
        <input id="caseNo" type="text" placeholder="‡§â‡§¶‡§æ. ZP/CEO/2025/123" />
      </div>
      <div>
        <label>‡§Ö‡§∞‡•ç‡§ú‡§¶‡§æ‡§∞‡§æ‡§ö‡•á ‡§®‡§æ‡§µ (Applicant Name)</label>
        <input id="applicant" type="text" placeholder="‡§â‡§¶‡§æ. ‡§∏‡•å. ‡§á‡§Ç‡§¶‡•Å‡§¨‡§æ‡§à ‡§π‡§æ‡§¶‡§∞ ‡§∞‡§æ‡§†‡•ã‡§°" />
      </div>
    </div>
    <label>‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§ï‡§æ‡§Ø‡§¶‡•á‡§∂‡•Ä‡§∞ ‡§ï‡§≤‡§Æ‡•á/‡§®‡§ø‡§Ø‡§Æ (Optional)</label>
    <input id="sections" type="text" placeholder="‡§â‡§¶‡§æ. GR ‡§¶‡§ø. 02/02/2023; MCS Rules; RTI S.19" />
    <label style="margin-top:10px">‡§™‡•ç‡§∞‡§ï‡§∞‡§£‡§æ‡§ö‡•á ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§∞‡•ç‡§£‡§® (Optional)</label>
    <textarea id="summary" rows="4" placeholder="‡§â‡§¶‡§æ. ‡§∏‡•ç‡§•‡§æ‡§®‡§ø‡§ï ‡§∞‡§π‡§ø‡§µ‡§æ‡§∏‡•Ä ‡§Ö‡§ü ‡§µ ‡§≠‡§∞‡§§‡•Ä ‡§§‡§ï‡•ç‡§∞‡§æ‡§∞‡•Ä ‡§¨‡§æ‡§¨‡§§..."></textarea>
  </div>

  <!-- Actions -->
  <div class="card">
    <h2>üõ†Ô∏è ‡§ï‡•É‡§§‡•Ä</h2>
    <div class="btns">
      <button class="btn b1" onclick="doAction('analyze')">üîç AI ANALYZE</button>
      <button class="btn b2" onclick="doAction('decision')">üìù GENERATE DECISION</button>
      <button class="btn b3" onclick="doAction('order')">üìã GENERATE ORDER (‡§Æ‡§∞‡§æ‡§†‡•Ä)</button>
      <button class="btn b4" onclick="printOutput()">üñ®Ô∏è PRINT / PDF</button>
    </div>
    <div id="status" class="status"></div>
  </div>

  <!-- Output -->
  <div id="outCard" class="card output">
    <h2 id="outTitle">Output</h2>
    <div id="outText" class="mono"></div>
    <div class="btns" style="margin-top:10px">
      <button class="btn b1" onclick="copyOut()">üìã Copy</button>
      <button class="btn b3" onclick="downloadOut()">üíæ Download</button>
    </div>
  </div>
</div>

<script>
  // Simple language toggle (default Marathi)
  let LANG = 'marathi';
  function setLang(l){ LANG=l; document.getElementById('lang-mr').classList.toggle('on', l==='marathi'); document.getElementById('lang-en').classList.toggle('on', l!=='marathi'); }

  // Status helper
  function show(msg, cls='ok'){ const s=document.getElementById('status'); s.className='status '+(cls==='ok'?'ok':cls==='warn'?'warn':'err'); s.textContent=msg; s.style.display='block'; }

  // File reads (text only). Keep simple & robust: use reader.text(); if user needs OCR/PDF deep, they can paste text.
  async function fileToText(file){
    try { return await file.text(); } catch{ return ''; }
  }

  // Capture uploads
  const caseFile = document.getElementById('caseFile');
  const grFile = document.getElementById('grFile');
  const caseName = document.getElementById('caseName');
  const grName = document.getElementById('grName');
  caseFile.addEventListener('change',()=>{ if(caseFile.files[0]){ caseName.style.display='inline-flex'; caseName.querySelector('span').textContent=caseFile.files[0].name; }});
  grFile.addEventListener('change',()=>{ if(grFile.files[0]){ grName.style.display='inline-flex'; grName.querySelector('span').textContent=grFile.files[0].name; }});

  // Main action
  async function doAction(mode){
    try{
      const caseTxtBox = document.getElementById('caseText').value.trim();
      const grTxtBox   = document.getElementById('grText').value.trim();
      if(!caseFile.files[0] && !caseTxtBox){ show('Case ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á: ‡§´‡§æ‡§à‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§æ','err'); return; }
      if(!grFile.files[0] && !grTxtBox){ show('GR ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á: ‡§´‡§æ‡§à‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§æ','err'); return; }

      show('Processing‚Ä¶ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§•‡§æ‡§Ç‡§¨‡§æ','warn');

      const caseText = caseTxtBox || (caseFile.files[0] ? await fileToText(caseFile.files[0]) : '');
      const grText   = grTxtBox   || (grFile.files[0]   ? await fileToText(grFile.files[0])   : '');

      const payload = {
        mode, language: LANG,
        caseText, grText,
        selectedCaseType: '', // (you can wire case type selector later)
        applicantName: document.getElementById('applicant').value.trim(),
        caseNumber: document.getElementById('caseNo').value.trim(),
        legalSections: document.getElementById('sections').value.trim(),
        caseDescription: document.getElementById('summary').value.trim()
      };

      const res = await fetch('/api/generate', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });

      if(!res.ok){ const e = await res.text(); show('Server error: '+e,'err'); return; }
      const data = await res.json();
      // Accepts either structured or raw fallback
      let title='Output', text='';
      if(mode==='analyze'){ title = (LANG==='marathi'?'‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§Ö‡§π‡§µ‡§æ‡§≤':'Analysis Report'); text = data.analysisText || data.output || data.raw || JSON.stringify(data,null,2); }
      if(mode==='decision'){ title = (LANG==='marathi'?'‡§®‡§ø‡§∞‡•ç‡§£‡§Ø':'Decision'); text = data.decisionText || data.output || data.raw || JSON.stringify(data,null,2); }
      if(mode==='order'){ title = (LANG==='marathi'?'‡§Ü‡§¶‡•á‡§∂':'Order'); text = data.orderText || data.output || data.raw || JSON.stringify(data,null,2); }

      document.getElementById('outTitle').textContent = title;
      document.getElementById('outText').textContent  = text;
      document.getElementById('outCard').classList.add('output','active');
      show('Done ‚úÖ','ok');
      window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
    }catch(err){
      show('Client error: '+(err?.message||err),'err');
    }
  }

  function copyOut(){ const t=document.getElementById('outText').textContent; navigator.clipboard.writeText(t); show('‡§ï‡•â‡§™‡•Ä ‡§ù‡§æ‡§≤‡•á','ok'); }
  function downloadOut(){
    const t=document.getElementById('outText').textContent;
    const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([t],{type:'text/plain'}));
    a.download='order_'+Date.now()+'.txt'; a.click(); URL.revokeObjectURL(a.href);
  }
  function printOutput(){
    const o=document.getElementById('outCard'); if(!o.classList.contains('active')){ show('‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ü‡§ß‡•Ä ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø/‡§Ü‡§¶‡•á‡§∂ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ','err'); return; }
    window.print();
  }
</script>
</body>
</html>
